(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{151:function(e,t,n){},193:function(e,t,n){e.exports=n(462)},204:function(e,t,n){},312:function(e,t,n){e.exports=n.p+"static/media/one-token.a3314b8b.svg"},313:function(e,t,n){e.exports=n.p+"static/media/two-tokens.8a98c32b.svg"},314:function(e,t,n){e.exports=n.p+"static/media/three-tokens.0ebc35c3.svg"},315:function(e,t,n){e.exports=n.p+"static/media/four-tokens.da8b9d75.svg"},316:function(e,t,n){e.exports=n.p+"static/media/five-tokens.7240809b.svg"},317:function(e,t,n){e.exports=n.p+"static/media/six-tokens.9b88cbc0.svg"},318:function(e,t,n){e.exports=n.p+"static/media/seven-tokens.d7817d9b.svg"},319:function(e,t,n){e.exports=n.p+"static/media/eight-tokens.a52db80b.svg"},320:function(e,t,n){e.exports=n.p+"static/media/nine-tokens.e2e95f09.svg"},328:function(e,t,n){},431:function(e,t,n){},433:function(e,t,n){},437:function(e,t,n){},439:function(e,t,n){},441:function(e,t,n){},449:function(e,t,n){},451:function(e,t,n){},453:function(e,t,n){},455:function(e,t,n){},457:function(e,t,n){},460:function(e,t,n){},462:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(15),c=n.n(i),s=n(471),o=n(473),l=n(465),u=n(472),d=n(17),p=n(67),h=n(7),m=n(8),f=n(12),b=n(11),g=n(13),v=n(474),y=n(310),O=n(90),E=n.n(O),k=function(e,t){return{type:"REMOVE_NODE",petriNetId:e,nodeId:t}},j=function(e,t,n){return{type:"SET_LABEL",petriNetId:e,nodeId:t,label:n}},N=function(e,t){return C(e,I(t))},I=function(e){return e.match.params.id},C=function(e,t){return e.petriNetsById[t]},T=n(14),S="transition",x=n(468),w=n(463),R=(n(204),v.a.Header),B=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(R,{className:"toolbar",style:{backgroundColor:this.props.backgroundColor}},this.props.children)}}]),t}(a.Component),A=(n(151),function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleChange=function(e){n.props.onNodeTypeChange(e.target.value)},n.handleChange=n.handleChange.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.activeNodeType;return r.a.createElement(B,{backgroundColor:"#008B27"},r.a.createElement(x.a.Group,{value:e,onChange:this.handleChange,buttonStyle:"solid"},r.a.createElement(x.a.Button,{value:S},"Transition"),r.a.createElement(x.a.Button,{value:"place"},"Place")),r.a.createElement(w.a,{id:"clear",icon:"delete",className:"btn-margin",onClick:this.props.onClear},"Clear"))}}]),t}(a.Component)),_=n(464),D=n(466),P=n(470),F=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Edge"),r.a.createElement(D.a,{layout:"vertical"},r.a.createElement(D.a.Item,{label:"Weight"},r.a.createElement(P.a,{id:"weight",min:1,value:this.props.weight,onChange:this.props.onWeightChange})),r.a.createElement(D.a.Item,null,r.a.createElement(w.a,{id:"delete",type:"danger",icon:"delete",block:!0,onClick:this.props.onDelete},"Delete"))))}}]),t}(a.Component),L=Object(_.a)(Object(d.b)(function(e,t){return{weight:e.petriNetsById[I(t)].edgesById[t.edgeId].weight}},function(e,t){return{onWeightChange:function(n){return e(function(e,t,n){return{type:"SET_WEIGHT",petriNetId:e,edgeId:t,weight:n}}(I(t),t.edgeId,n))},onDelete:function(){return e((n=I(t),a=t.edgeId,{type:"REMOVE_EDGE",petriNetId:n,edgeId:a}));var n,a}}})(F)),M=n(469),U=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).onChange=function(e){new RegExp("^[1-9]?[0-9]{0,3}$").test(e)&&(n.setState({number:e}),n.props.onNumberOfTokensChange(e))},n.handleLabelChange=n.handleLabelChange.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"handleLabelChange",value:function(e){this.props.onLabelChange(e.target.value)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Place"),r.a.createElement(D.a,{layout:"vertical"},r.a.createElement(D.a.Item,{label:""},r.a.createElement(M.a,{id:"label",placeholder:"Enter name",value:this.props.label,onChange:this.handleLabelChange})),r.a.createElement(D.a.Item,{label:"Initial number of tokens"},r.a.createElement(P.a,{id:"numberOfTokens",min:0,value:this.props.numberOfTokens,onChange:this.onChange})),r.a.createElement(D.a.Item,null,r.a.createElement(w.a,{id:"delete",type:"danger",icon:"delete",block:!0,onClick:this.props.onDelete},"Delete"))))}}]),t}(a.Component),G=function(e,t){return Object.values(e.edgesById).filter(function(e){return e.to===t})},H=function(e,t){return Object.values(e.edgesById).filter(function(e){return e.from===t})},z=function(e,t){return e.markings[e.markings.length-1][t]},V=function(e,t){var n=G(e,t),a=0,r=0;return n.forEach(function(t){a+=z(e,t.from),r+=t.weight}),r-a},J=function(e){return Object.values(e.nodesById).filter(function(e){return e.type===S}).filter(function(t){return!G(e,t.id).some(function(t){return t.weight>z(e,t.from)})&&!H(e,t.id).some(function(t){return!function(e,t,n){var a=e.nodesById[t];return void 0===a.capacityLimit||a.capacityLimit-z(e,t)>=n}(e,t.to,t.weight)})})},K=function(e){return Object.values(e.markings[e.markings.length-1]).reduce(function(e,t){return e+t})},Z=function(e,t){return G(e,t).map(function(e){return e.weight}).reduce(function(e,t){return e+t})},W=function(e,t){return H(e,t).map(function(e){return e.weight}).reduce(function(e,t){return e+t})},Y=function(e,t){return Object.values(e.nodesById).filter(function(e){return e.type===S&&e.label===t})[0]},$=Object(_.a)(Object(d.b)(function(e,t){var n=N(e,t),a=n.nodesById[t.placeId];return{label:a.label,capacityLimit:a.capacityLimit,numberOfTokens:z(n,t.placeId)}},function(e,t){return{onLabelChange:function(n){return e(j(I(t),t.placeId,n))},onCapacityLimitChange:function(n){return e(function(e,t){var n=I(e);return void 0===t||null===t||""===t?function(e,t){return{type:"REMOVE_CAPACITY_LIMIT",petriNetId:e,placeId:t}}(n,e.placeId):function(e,t,n){return{type:"SET_CAPACITY_LIMIT",petriNetId:e,placeId:t,capacityLimit:n}}(n,e.placeId,t)}(t,n))},onNumberOfTokensChange:function(n){return e(function(e,t,n){return{type:"SET_INITIAL_NUMBER_OF_TOKENS",petriNetId:e,placeId:t,numberOfTokens:n}}(I(t),t.placeId,n||0))},onDelete:function(){return e(k(I(t),t.placeId))}}})(U)),q=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleLabelChange=n.handleLabelChange.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"handleLabelChange",value:function(e){var t=e.target.value;new RegExp("^[a-zA-Z]?$").test(t)&&this.props.onLabelChange(e.target.value)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Transition"),r.a.createElement(D.a,{layout:"vertical"},r.a.createElement("p",{style:{color:"darkred"}},"Name should be a letter corresponding to trace event"),r.a.createElement(D.a.Item,{label:""},r.a.createElement(M.a,{id:"label",placeholder:"Enter name",value:this.props.label,onChange:this.handleLabelChange})),r.a.createElement(D.a.Item,null,r.a.createElement(w.a,{id:"delete",type:"danger",icon:"delete",block:!0,onClick:this.props.onDelete},"Delete"))))}}]),t}(a.Component),Q=Object(_.a)(Object(d.b)(function(e,t){return{label:N(e,t).nodesById[t.transitionId].label}},function(e,t){return{onLabelChange:function(n){return e(j(I(t),t.transitionId,n))},onDelete:function(){return e(k(I(t),t.transitionId))}}})(q)),X=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){switch(this.props.elementType){case"EDGE":return this.renderEdgeForm();case"NODE":return this.renderNodeForm();default:return null}}},{key:"renderEdgeForm",value:function(){return r.a.createElement(L,{edgeId:this.props.element.id})}},{key:"renderNodeForm",value:function(){switch(this.props.element.type){case"place":return this.renderPlaceForm();case S:return this.renderTransitionForm();default:return null}}},{key:"renderPlaceForm",value:function(){return r.a.createElement($,{placeId:this.props.element.id})}},{key:"renderTransitionForm",value:function(){return r.a.createElement(Q,{transitionId:this.props.element.id})}}]),t}(a.Component),ee=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).state={display:!1},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){return e.setState({display:!0})},0)}},{key:"render",value:function(){return!1===this.state.display?null:r.a.createElement(r.a.Fragment,null,this.props.children)}}]),t}(a.Component),te=(n(328),v.a.Content),ne=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(te,{className:"graph_area"},r.a.createElement(ee,null,this.props.children))}}]),t}(a.Component),ae=n(136),re=n.n(ae),ie=function(){function e(){Object(h.a)(this,e);var t={primitive:!0,max:100};this._edgeCfg=re()(this._edgeCfg,t),this._nodeCfg=re()(this._nodeCfg,t)}return Object(m.a)(e,[{key:"_edgeCfg",value:function(e,t,n,a,r,i,c){return{group:"edges",data:{id:e,source:t,target:n,weight:a},selected:r,selectable:i,grabbable:c}}},{key:"edgeCfg",value:function(e){var t=e.id,n=e.source,a=e.target,r=e.weight,i=void 0===r?1:r,c=e.selected,s=void 0!==c&&c,o=e.selectable,l=void 0===o||o,u=e.grabbable,d=void 0===u||u;return this._edgeCfg(t,n,a,i,s,l,d)}},{key:"_nodeCfg",value:function(e,t,n,a,r,i,c,s,o,l){return{group:"nodes",data:{id:e,type:t,label:n,numberOfTokens:a},position:{x:r,y:i},selected:c,selectable:s,grabbable:o,classes:l}}},{key:"nodeCfg",value:function(e){var t=e.id,n=e.type,a=e.label,r=e.numberOfTokens,i=e.position,c=i.x,s=i.y,o=e.selected,l=void 0!==o&&o,u=e.selectable,d=void 0===u||u,p=e.grabbable,h=void 0===p||p,m=e.classes;return this._nodeCfg(t,n,a,r,c,s,l,d,h,m)}}]),e}(),ce=n(16),se=function(e,t){return e[t.data.id]=t,e},oe=function(){function e(t,n,a){var r=this,i=a.selectedId,c=a.highlightedIds,s=void 0===c?[]:c,o=a.locked,l=void 0!==o&&o;Object(h.a)(this,e),this.isHighlighted=function(e){return-1!==r.highlightedIds.indexOf(e)},this.isSelected=function(e){return r.selectedId===e},this.nodeCfgsById=function(){return Object.values(r.petriNet.nodesById).map(r.nodeCfg.bind(r)).reduce(se,{})},this.nodeLabel=function(e){var t=[];return void 0!==e.label&&e.label.length>0&&t.push(e.label),void 0!==e.capacityLimit&&t.push("(max. ".concat(e.capacityLimit,")")),t.join(" ")},this.nodeNumberOfTokens=function(e){return z(r.petriNet,e.id)},this.petriNet=t,this.factory=n,this.selectedId=i,this.highlightedIds=s,this.locked=l}return Object(m.a)(e,[{key:"edgeCfg",value:function(e){return this.factory.edgeCfg({id:e.id,source:e.from,target:e.to,weight:e.weight,selected:this.isSelected(e.id),selectable:!this.locked,grabbable:!this.locked})}},{key:"edgeCfgsById",value:function(){return Object.values(this.petriNet.edgesById).map(this.edgeCfg.bind(this)).reduce(se,{})}},{key:"map",value:function(){return Object(ce.a)({},this.nodeCfgsById(),this.edgeCfgsById())}},{key:"nodeCfg",value:function(e){return this.factory.nodeCfg({id:e.id,type:e.type,label:this.nodeLabel(e),numberOfTokens:this.nodeNumberOfTokens(e),position:e.position,selected:this.isSelected(e.id),selectable:!this.locked,grabbable:!this.locked,classes:this.nodeClasses(e)})}},{key:"nodeClasses",value:function(e){var t=[e.type];return this.isHighlighted(e.id)&&t.push("highlighted"),t.join(" ")}}]),e}(),le=n(95),ue=n.n(le),de=n(311),pe=n.n(de),he=r.a.createContext();ue.a.use(pe.a);var me=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).componentDidMount=function(){n.initEdgeHandles()},n.componentDidUpdate=function(){n.initEdgeHandles()},n.edgeParams=n.edgeParams.bind(Object(T.a)(Object(T.a)(n))),n.edgeType=n.edgeType.bind(Object(T.a)(Object(T.a)(n))),n.handleComplete=n.handleComplete.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"edgeParams",value:function(e,t){return this.props.edgeParams(e.id(),t.id())}},{key:"edgeType",value:function(e,t){if(this.shouldAddEdge(e,t))return"flat"}},{key:"handleComplete",value:function(e,t){this.props.onAddEdge(e.id(),t.id())}},{key:"initEdgeHandles",value:function(){void 0!==this.context&&(void 0!==this.edgehandles&&this.edgehandles.destroy(),this.edgehandles=this.context.edgehandles({complete:this.handleComplete,edgeParams:this.edgeParams,edgeType:this.edgeType,snap:this.props.snap}))}},{key:"render",value:function(){return null}},{key:"shouldAddEdge",value:function(e,t){return 0!==t.length&&(!t.same(this.edgehandles.handleNode)&&this.props.shouldAddEdge(e.id(),t.id()))}}]),t}(a.PureComponent);me.contextType=he;var fe=me,be=n(59),ge=n.n(be),ve=function(e,t){if(void 0!==e)return function(n){return e(t[n])}},ye=function(e){var t=e.prev,n=e.current,a=e.onAdd,r=e.onRemove,i=e.onRemain,c=n.filter(function(e){return-1===t.indexOf(e)}),s=t.filter(function(e){return-1===n.indexOf(e)}),o=n.filter(function(e){return-1===c.indexOf(e)});void 0!==a&&c.forEach(function(e){return a(e)}),void 0!==r&&s.forEach(function(e){return r(e)}),void 0!==i&&o.forEach(function(e){return i(e)})},Oe=function(e){var t=e.prev,n=e.current,a=e.onAdd,r=e.onRemove,i=e.onRemain;ye({prev:Object.keys(t),current:Object.keys(n),onAdd:ve(a,n),onRemove:ve(r,t),onRemain:ve(i,n)})},Ee=n(98),ke=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this.props,t=e.divRef,n=Object(Ee.a)(e,["divRef"]);return r.a.createElement("div",Object.assign({ref:t},n))}}]),t}(a.Component),je=(n(431),function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleClick=function(e){e.target!==n.cy?n.callCallback(n.props.onClickOnElement,n.elementType(e.target),e.target.id()):n.callCallback(n.props.onClickOnBackground,Object(ce.a)({},e.position))},n.handleFree=function(e){n.hasNodeMoved(e.target)&&n.callCallback(n.props.onMove,e.target.id(),Object(ce.a)({},e.target.position()))},n.handleGrab=function(e){e.target.select()},n.handleSelect=function(e){n.callCallback(n.props.onSelect,n.elementType(e.target),e.target.id())},n.handleUnselect=function(e){n.callCallback(n.props.onUnselect,n.elementType(e.target),e.target.id())},n.state={},n.cyContainerRef=r.a.createRef(),n.handleClick=n.handleClick.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"addElement",value:function(e){this.cy.add(ge()(e))}},{key:"callCallback",value:function(e){if(void 0!==e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];e.apply(void 0,n)}}},{key:"componentDidMount",value:function(){this.initCytoscape(),this.setLoaded()}},{key:"componentDidUpdate",value:function(){this.updateCytoscape(),this.setLoaded()}},{key:"elementType",value:function(e){return"nodes"===e.group()?"NODE":"EDGE"}},{key:"findElement",value:function(e){var t=this.cy.elements("#".concat(e.data.id));if(1===t.length)return t.first();if(t.length>0)throw new Error("ambiguous id")}},{key:"hasNodeMoved",value:function(e){var t=this.loaded.elementsById[e.id()].position;return t.x!==e.position().x||t.y!==e.position().y}},{key:"initCytoscape",value:function(){var e=Object.values(this.props.elementsById||{});this.cy=ue()({container:this.cyContainerRef.current,elements:ge()(e),layout:ge()(this.props.layout||{}),maxZoom:this.props.maxZoom,style:ge()(this.props.style||{})}),this.cy.on("free",this.handleFree),this.cy.on("grab",this.handleGrab),this.cy.on("select",this.handleSelect),this.cy.on("unselect",this.handleUnselect),this.cy.on("vclick",this.handleClick),this.setState({cy:this.cy})}},{key:"removeElement",value:function(e){var t=this.findElement(e);void 0!==t&&t.remove()}},{key:"render",value:function(){return r.a.createElement("div",{className:"graph"},r.a.createElement(ke,{className:"cytoscape_container",divRef:this.cyContainerRef}),r.a.createElement(he.Provider,{value:this.state.cy},this.props.children))}},{key:"setLoaded",value:function(){this.loaded={elementsById:this.props.elementsById,layout:this.props.layout,style:this.props.style}}},{key:"updateCytoscape",value:function(){this.updateElements(),this.updateOptions()}},{key:"updateElement",value:function(e){if(this.loaded.elementsById[e.data.id]!==e){var t=this.findElement(e);void 0!==t&&t.json(ge()(e))}}},{key:"updateElements",value:function(){var e=this,t=this.loaded.elementsById,n=this.props.elementsById;t!==n&&Oe({prev:t,current:n,onAdd:function(t){return e.findElement(t)?e.updateElement(t):e.addElement(t)},onRemove:function(t){return e.removeElement(t)},onRemain:function(t){return e.updateElement(t)}})}},{key:"updateOption",value:function(e){this.props[e]!==this.loaded[e]&&this.cy[e](ge()(this.props[e]))}},{key:"updateOptions",value:function(){var e=this;["layout","maxZoom","style"].map(function(t){return e.updateOption(t)})}}]),t}(a.PureComponent)),Ne=n(312),Ie=n.n(Ne),Ce=n(313),Te=n.n(Ce),Se=n(314),xe=n.n(Se),we=n(315),Re=n.n(we),Be=n(316),Ae=n.n(Be),_e=n(317),De=n.n(_e),Pe=n(318),Fe=n.n(Pe),Le=n(319),Me=n.n(Le),Ue=n(320),Ge=n.n(Ue),He='-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',ze={},Ve=function(e){return void 0===ze[e]&&(ze[e]=function(e){var t='\n    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80">\n      <text x="50%" y="50%" dy=".3em" fill="black" style=\'font-family: '.concat(He,"; font-size: 20px; text-anchor: middle;'>\n        ").concat(e,"\n      </text>\n    </svg>\n  ");return"data:image/svg+xml;utf8,"+encodeURIComponent(t)}(e)),ze[e]},Je=[Ie.a,Te.a,xe.a,Re.a,Ae.a,De.a,Fe.a,Me.a,Ge.a],Ke=[{selector:"*",style:{"font-size":20,"font-family":He,color:"#242424"}},{selector:"node",style:{"border-color":"#404040","border-width":2,"text-valign":"bottom","text-halign":"center","text-margin-y":10,"background-color":"#BFBFBF","background-fit":"cover",label:"data(label)"}},{selector:"node.highlighted",style:{"background-color":"#1890ff"}},{selector:"node:selected",style:{"border-color":"#1890ff"}},{selector:"node.place",style:{height:80,width:80,"background-image":function(e){return function(e){var t=e.data("numberOfTokens");return 0===t?[]:t<10?Je[t-1]:Ve(t)}(e)}}},{selector:"node.transition",style:{shape:"rectangle",height:80,width:20}},{selector:"node.token",style:{height:10,width:10,"background-color":"black","border-width":0}},{selector:"edge",style:{width:2,"target-arrow-shape":"triangle","line-color":"#404040","target-arrow-color":"#404040","curve-style":"bezier",label:"data(weight)","text-margin-y":14}},{selector:"edge:selected",style:{"line-color":"#1890ff","target-arrow-color":"#1890ff"}},{selector:".eh-ghost-edge.eh-preview-active",style:{opacity:0}}],Ze=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).render=function(){return r.a.createElement(je,Object.assign({style:Ke,layout:n.state.layout,elementsById:n.elementsById()},n.props),n.renderEdgeHandles(),n.props.children)},n.elementCfgFactory=new ie,n.edgeParams=n.edgeParams.bind(Object(T.a)(Object(T.a)(n))),n.shouldAddEdge=n.shouldAddEdge.bind(Object(T.a)(Object(T.a)(n))),n.state={layout:{name:"preset"}},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"edgeParams",value:function(e,t){return this.elementCfgFactory.edgeCfg({id:"".concat(e,"_").concat(t),source:e,target:t})}},{key:"elementsById",value:function(){return new oe(this.props.petriNet,this.elementCfgFactory,{selectedId:this.props.selectedId,highlightedIds:this.props.highlightedIds,locked:this.props.locked}).map()}},{key:"shouldAddEdge",value:function(e,t){if(e===t)return!1;var n=this.props.petriNet,a=n.nodesById[e],r=n.nodesById[t];return void 0!==a&&void 0!==r&&a.type!==r.type&&-1===G(n,r.id).map(function(e){return e.from}).indexOf(a.id)}},{key:"renderEdgeHandles",value:function(){if(!0!==this.props.locked)return r.a.createElement(fe,{onAddEdge:this.props.onAddEdge,shouldAddEdge:this.shouldAddEdge,snap:!0,edgeParams:this.edgeParams})}}]),t}(a.PureComponent),We=(n(433),v.a.Sider),Ye=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).clearPetriNet=function(){n.props.petriNet.edgesById={},n.props.petriNet.nodesById={},n.props.petriNet.markings=[{}],n.setState({selected:{}})},n.state={activeNodeType:S,selected:{}},n.handleAddEdge=n.handleAddEdge.bind(Object(T.a)(Object(T.a)(n))),n.handleClickOnBackground=n.handleClickOnBackground.bind(Object(T.a)(Object(T.a)(n))),n.handleNodeTypeChange=n.handleNodeTypeChange.bind(Object(T.a)(Object(T.a)(n))),n.handleSelect=n.handleSelect.bind(Object(T.a)(Object(T.a)(n))),n.handleUnselect=n.handleUnselect.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"getSelectedElement",value:function(){var e=this.state.selected.id;switch(this.state.selected.type){case"EDGE":return this.props.petriNet.edgesById[e];case"NODE":return this.props.petriNet.nodesById[e];default:return}}},{key:"handleAddEdge",value:function(e,t){this.props.onAddEdge(e,t),this.setState({selected:{type:"EDGE",id:"".concat(e,"_").concat(t)}})}},{key:"handleClickOnBackground",value:function(e){var t=E()();this.props.onAddNode(t,this.state.activeNodeType,e),this.setState({selected:{type:"NODE",id:t}})}},{key:"handleSelect",value:function(e,t){this.setState({selected:{type:e,id:t}})}},{key:"handleUnselect",value:function(e){e===this.state.selected.id&&this.setState({selected:{}})}},{key:"handleNodeTypeChange",value:function(e){this.setState({activeNodeType:e})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(A,{activeNodeType:this.state.activeNodeType,onNodeTypeChange:this.handleNodeTypeChange,onClear:this.clearPetriNet}),r.a.createElement(v.a,null,r.a.createElement(ne,null,r.a.createElement(Ze,{petriNet:this.props.petriNet,selectedId:this.state.selected.id,maxZoom:1,onAddEdge:this.handleAddEdge,onClickOnBackground:this.handleClickOnBackground,onMove:this.props.onMove,onSelect:this.handleSelect,onUnselect:this.handleUnselect})),this.renderSidebar()))}},{key:"renderSidebar",value:function(){var e=this.getSelectedElement();if(void 0!==e)return r.a.createElement(We,{className:"editor__sidebar",width:260},r.a.createElement(X,{element:e,elementType:this.state.selected.type}))}}]),t}(a.Component),$e=Object(y.a)(Object(d.b)(function(e,t){return{petriNet:N(e,t)}},function(e,t){return{onAddEdge:function(n,a){return e(function(e,t,n){return{type:"ADD_EDGE",petriNetId:e,edgeId:"".concat(t,"_").concat(n),from:t,to:n}}(I(t),n,a))},onAddNode:function(n,a,r){return e(function(e,t,n,a){return{type:"ADD_NODE",petriNetId:e,nodeId:t,nodeType:n,position:a}}(I(t),n,a,r))},onMove:function(n,a){return e(function(e,t,n){return{type:"MOVE_NODE",petriNetId:e,nodeId:t,position:n}}(I(t),n,a))}}})(Ye)),qe=n(19),Qe=n.n(qe),Xe=n(29),et=n(28),tt=function(){function e(t){Object(h.a)(this,e),this.cytoscape=t.cy(),this.edgeElement=t,this.speed=350}return Object(m.a)(e,[{key:"play",value:function(){var e=Object(Xe.a)(Qe.a.mark(function e(t){var n;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.speed=t,n=this.addToken(),e.next=4,this.animateToken(n);case 4:this.removeToken(n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addToken",value:function(){return this.cytoscape.add({group:"nodes",classes:"token",position:this.edgeElement.sourceEndpoint()})}},{key:"animateToken",value:function(e){throw new Error("Not implemented")}},{key:"removeToken",value:function(e){e.remove()}}]),e}(),nt=function(e,t,n,a){return(1-a)*(1-a)*e+2*(1-a)*a*t+a*a*n},at=function(e,t,n,a){return{x:nt(e.x,t.x,n.x,a),y:nt(e.y,t.y,n.y,a)}},rt=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"pointOnBezierCurve",value:function(e){return at(this.edgeElement.sourceEndpoint(),this.edgeElement.controlPoints()[0],this.edgeElement.targetEndpoint(),e)}},{key:"animateToken",value:function(e){for(var t=this.speed/30,n=0;n<29;n++){var a=1/30*(n+1);e.animate({position:this.pointOnBezierCurve(a),duration:t})}return e.animation({position:this.edgeElement.targetEndpoint(),duration:t,queue:!0}).play().promise()}}]),t}(tt),it=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"animateToken",value:function(e){return e.animation({position:this.edgeElement.targetEndpoint(),duration:this.speed,queue:!0}).play().promise()}}]),t}(tt),ct=function(e){return function(e){return void 0!==e.controlPoints()}(e)?new rt(e):new it(e)},st=function(){function e(t){Object(h.a)(this,e),this.canceled=!1,this.cytoscape=t.cy(),this.transitionElement=t,this.speed=350}return Object(m.a)(e,[{key:"animateIncomingEdge",value:function(){var e=Object(Xe.a)(Qe.a.mark(function e(t){var n,a;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.source(),a=n.data("numberOfTokens")-t.data("weight"),n.data("numberOfTokens",a),e.next=5,this.animateTokenFlowOfEdge(t);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"animateIncomingEdges",value:function(){if(!0===this.canceled)return Promise.resolve();var e=this.transitionElement.incomers("edge").map(this.animateIncomingEdge.bind(this));return Promise.all(e)}},{key:"animateOutgoingEdge",value:function(){var e=Object(Xe.a)(Qe.a.mark(function e(t){var n,a;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.animateTokenFlowOfEdge(t);case 2:if(!0!==this.canceled){e.next=4;break}return e.abrupt("return",Promise.resolve());case 4:n=t.target(),a=n.data("numberOfTokens")+t.data("weight"),n.data("numberOfTokens",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"animateOutgoingEdges",value:function(){if(!0===this.canceled)return Promise.resolve();var e=this.transitionElement.outgoers("edge").map(this.animateOutgoingEdge.bind(this));return Promise.all(e)}},{key:"animateTokenFlowOfEdge",value:function(e){return ct(e).play(this.speed)}},{key:"cancel",value:function(){this.canceled=!0}},{key:"play",value:function(){var e=Object(Xe.a)(Qe.a.mark(function e(t){return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.speed=t,e.next=3,this.animateIncomingEdges();case 3:return e.next=5,this.animateOutgoingEdges();case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),ot=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"play",value:function(){var e=Object(Xe.a)(Qe.a.mark(function e(){var t;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.context.elements("#".concat(this.props.elementId)).first(),this.animation=new this.props.animation(t),e.next=4,this.animation.play(this.props.speed);case 4:void 0!==this.props.onEnd&&this.props.onEnd();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.animation.cancel()}},{key:"componentDidMount",value:function(){this.play()}},{key:"componentWillUnmount",value:function(){this.cancel()}},{key:"render",value:function(){return null}}]),t}(a.PureComponent);ot.contextType=he;var lt=ot,ut="Slow",dt="Fast",pt=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.onSpeedChange(e.target.value)},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.speed;return r.a.createElement(B,{backgroundColor:"#008B27"},r.a.createElement(x.a.Group,{value:e,onChange:this.handleChange,buttonStyle:"solid"},r.a.createElement(x.a.Button,{value:ut},ut),r.a.createElement(x.a.Button,{value:dt},dt)),r.a.createElement(w.a,{id:"run",icon:"play-circle",className:"btn-margin",onClick:this.props.onRun},"Run"),r.a.createElement(w.a,{id:"runStep",icon:"play-circle",className:"btn-margin",onClick:this.props.onRunStep},"Run step"),r.a.createElement(w.a,{id:"pause",icon:"pause",className:"btn-margin",onClick:this.props.onPause},"Pause"),r.a.createElement(w.a,{id:"reset",icon:"reload",className:"btn-margin",onClick:this.props.onReset},"Reset"))}}]),t}(a.Component),ht=n(39),mt=n(97),ft=(n(437),n(439),function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"logo"})}}]),t}(a.Component)),bt={fitness:void 0,isRunning:!1,traceIdx:0,pos:0,produced:0,consumed:0,missing:0,remaining:0,curProduced:0,curConsumed:0,curMissing:0,curRemaining:0},gt=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).validatePetriNet=function(){var e=n.props.petriNet;return Object.values(e.edgesById).length>=Object.values(e.nodesById).length-1},n.validateTransitionNames=function(){var e=new Set,t=Object.values(n.props.petriNet.nodesById).filter(function(e){return e.type===S});t.forEach(function(t){null!==t.label&&void 0!==t.label&&""!==t.label&&e.add(t.label)});var a=new Set;n.props.petriNet.traces.map(function(e){return e.trace}).forEach(function(e){e.split("").forEach(function(e){a.add(e)})});var r,i;return t.length===e.size&&(i=e,(r=a).size===i.size&&Object(et.a)(r).every(function(e){return i.has(e)}))},n.changeSpeed=function(e){switch(e){case dt:return void n.setState({speed:dt,animationSpeed:100,waitTime:350});default:n.setState({speed:ut,animationSpeed:550,waitTime:1650})}},n.onMissingToken=Object(Xe.a)(Qe.a.mark(function e(){var t,a,r,i,c,s;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Missing token"),t=n.props.petriNet,a=n.state,r=a.traceIdx,i=a.pos,c=Y(t,t.traces[r].trace[i]),s=n.state.curMissing+V(t,c.id),n.props.onAddTokens(c.id),n.setState({curMissing:s});case 7:case"end":return e.stop()}},e,this)})),n.isFinished=function(){var e=n.props.petriNet.traces,t=n.state.traceIdx;return e.length<=t},n.updateUiTokens=function(e){var t=n.state,a=t.produced,r=t.consumed,i=t.missing,c=t.remaining,s=n.state,o=s.curProduced,l=s.curConsumed,u=s.curMissing,d=s.curRemaining;void 0!==e&&(o*=e.number,l*=e.number,u*=e.number,d*=e.number),n.setState({produced:a+o,consumed:r+l,missing:i+u,remaining:c+d,curProduced:0,curConsumed:0,curMissing:0,curRemaining:0})},n.updateTransitionTokens=function(e){var t=n.props.petriNet,a=n.state.curProduced+W(t,e),r=n.state.curConsumed+Z(t,e);n.setState({curProduced:a,curConsumed:r})},n.updateState=function(){var e=n.state,t=e.traceIdx,a=e.pos;n.props.petriNet.traces[t].trace.length===a+1?n.setState({traceIdx:t+1,pos:0,reset:!0}):n.setState({pos:a+1})},n.onAlgorithmFinished=function(){var e=K(n.props.petriNet);n.setState({curRemaining:e-1}),n.updateUiTokens(n.props.petriNet.traces[n.state.traceIdx-1]);var t=n.state,a=t.produced,r=t.consumed,i=.5*(1-t.missing/r)+.5*(1-t.remaining/a);n.setState({fitness:Number(i).toFixed(6)}),ht.Notify.success("Algorithm has finished!")},n.onNextTrace=Object(Xe.a)(Qe.a.mark(function e(){var t,a,r,i,c;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("next trace"),t=n.state.traceIdx,a=n.props.petriNet,a.traces[t].active=!0,t-1>=0&&(a.traces[t-1].active=!1),r=0===(r=K(a))?1:r,i=n.state.curProduced,c=n.state.curConsumed,n.setState({reset:!1,curRemaining:r-1,curProduced:i,curConsumed:c}),n.props.petriNet.markings=JSON.parse(JSON.stringify(n.markings)),n.updateUiTokens(a.traces[t-1]),e.next=15,n.props.onReset();case 15:case"end":return e.stop()}},e,this)})),n.tryRunStep=function(){n.state.isRunning||n.isStepReady&&(n.isStepReady=!1,n.runStep(),setTimeout(function(){return n.isStepReady=!0},n.state.waitTime+30))},n.validateBeforeRun=function(){return n.validatePetriNet()?0===n.props.petriNet.traces.length?(ht.Notify.failure("There are no case traces to run"),!1):!!n.validateTransitionNames()||(ht.Notify.failure("Transition names are incorrect"),!1):(ht.Notify.failure("Process model is not consistent"),!1)},n.runStep=Object(Xe.a)(Qe.a.mark(function e(){var t,a,r,i,c,s,o;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("idx: ",n.state.traceIdx,"pos: ",n.state.pos),n.validateBeforeRun()){e.next=3;break}return e.abrupt("return");case 3:if(!n.isFinished()){e.next=6;break}return n.onAlgorithmFinished(),e.abrupt("return");case 6:if(t=n.state,a=t.traceIdx,r=t.pos,i=t.reset,c=n.props.petriNet,s=c.traces[a],0!==r||!i){e.next=13;break}return e.next=12,n.onNextTrace();case 12:return e.abrupt("return");case 13:if(1!==(o=J(c).filter(function(e){return e.label===s.trace[r]})).length){e.next=21;break}return e.next=17,n.handleClickOnElement(null,o[0].id);case 17:n.updateTransitionTokens(o[0].id),n.updateState(),e.next=23;break;case 21:return e.next=23,n.onMissingToken();case 23:case"end":return e.stop()}},e,this)})),n.run=Object(Xe.a)(Qe.a.mark(function e(){return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.isRunning){e.next=2;break}return e.abrupt("return");case 2:if(n.validateBeforeRun()){e.next=4;break}return e.abrupt("return");case 4:n.setState({isRunning:!0});case 5:if(n.isFinished()){e.next=14;break}return e.next=8,n.runStep();case 8:return e.next=10,n.wait(n.state.waitTime);case 10:if(n.state.isRunning){e.next=12;break}return e.abrupt("return");case 12:e.next=5;break;case 14:n.onAlgorithmFinished(),n.setState({isRunning:!1});case 16:case"end":return e.stop()}},e,this)})),n.pause=function(){n.state.isRunning&&(n.setState({isRunning:!1}),ht.Notify.info("Algorithm paused"))},n.reset=Object(Xe.a)(Qe.a.mark(function e(){var t;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.state.isRunning){e.next=3;break}return e.next=3,n.wait(50);case 3:n.setState(Object(ce.a)({reset:!0},bt)),(t=n.state.traceIdx)<n.props.petriNet.traces.length&&t>=0&&(n.props.petriNet.traces[t].active=!1),0!==n.props.petriNet.traces.length&&(n.props.petriNet.traces[n.props.petriNet.traces.length-1].active=!1),n.props.petriNet.markings=JSON.parse(JSON.stringify(n.markings)),n.props.onReset();case 9:case"end":return e.stop()}},e,this)})),n.renderResult=function(){if(n.isFinished()&&0!==n.props.petriNet.traces.length&&void 0!==n.state.fitness)return r.a.createElement("div",{className:"wrapper"},r.a.createElement("br",null),r.a.createElement("h6",{className:"center"},"Result"),r.a.createElement(ft,null),r.a.createElement("br",null),r.a.createElement("h6",null,"Fitness = ",n.state.fitness))},n.renderCurrentTraceInfo=function(){var e=n.props.petriNet.traces.filter(function(e){return e.active})[0];if(void 0!==e)return r.a.createElement("p",null,"Multiplier: x",e.number)},n.handleAnimationEnd=n.handleAnimationEnd.bind(Object(T.a)(Object(T.a)(n))),n.handleClickOnElement=n.handleClickOnElement.bind(Object(T.a)(Object(T.a)(n))),n.state=Object(ce.a)({reset:!0,animationSpeed:550,waitTime:1650,speed:ut},bt),n.markings=JSON.parse(JSON.stringify(n.props.petriNet.markings)),n.isStepReady=!0,n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"activeTransitionIds",value:function(){return void 0===this.props.petriNet?[]:J(this.props.petriNet).map(function(e){return e.id})}},{key:"componentWillUnmount",value:function(){this.reset()}},{key:"handleAnimationEnd",value:function(){this.props.onFireTransition(this.state.selected),this.setState({selected:void 0})}},{key:"handleClickOnElement",value:function(e,t){this.isTransitionActive(t)&&void 0===this.state.selected&&this.setState({selected:t})}},{key:"highlightedIds",value:function(){return this.state.selected?[]:this.activeTransitionIds()}},{key:"isTransitionActive",value:function(e){return-1!==this.activeTransitionIds().indexOf(e)}},{key:"wait",value:function(){var e=Object(Xe.a)(Qe.a.mark(function e(t){var n;return Qe.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){return new Promise(function(t){return setTimeout(t,e)})},e.next=3,n(void 0===t?1500:t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(pt,{onRun:this.run,onRunStep:this.tryRunStep,onReset:this.reset,onPause:this.pause,onSpeedChange:this.changeSpeed,speed:this.state.speed}),r.a.createElement(v.a,null,r.a.createElement(ne,null,r.a.createElement(Ze,{petriNet:this.props.petriNet,locked:!0,maxZoom:1,highlightedIds:this.highlightedIds(),onClickOnElement:this.handleClickOnElement},this.renderAnimation())),r.a.createElement(mt.a,{className:"editor__sidebar",width:300},r.a.createElement("div",null,r.a.createElement("h5",null,"Token based replay"),r.a.createElement("div",{className:"wrapper"},r.a.createElement("br",null),r.a.createElement("h6",{className:"center"},"Total"),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Produced:"),r.a.createElement("p",{className:"inline-right"},this.state.produced)),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Consumed:"),r.a.createElement("p",{className:"inline-right"},this.state.consumed)),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Missing: "),r.a.createElement("p",{className:"inline-right"},this.state.missing)),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Remaining: "),r.a.createElement("p",{className:"inline-right"},this.state.remaining))),r.a.createElement("div",{className:"wrapper"},r.a.createElement("br",null),r.a.createElement("h6",{className:"center"},"Current trace"),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Produced:"),r.a.createElement("p",{className:"inline-right"},this.state.curProduced)),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Consumed:"),r.a.createElement("p",{className:"inline-right"},this.state.curConsumed)),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Missing: "),r.a.createElement("p",{className:"inline-right"},this.state.curMissing)),r.a.createElement("div",{className:"parent"},r.a.createElement("p",{className:"inline-left"},"Remaining: "),r.a.createElement("p",{className:"inline-right"},this.state.curRemaining)),this.renderCurrentTraceInfo()),this.renderResult()))))}},{key:"renderAnimation",value:function(){return void 0===this.state.selected?null:r.a.createElement(lt,{elementId:this.state.selected,animation:st,speed:this.state.animationSpeed,onEnd:this.handleAnimationEnd})}}]),t}(a.Component),vt=Object(y.a)(Object(d.b)(function(e,t){return{petriNet:e.petriNetsById[I(t)]}},function(e,t){return{onFireTransition:function(n){return e(function(e,t){return{type:"FIRE_TRANSITIONS",petriNetId:e,transitionId:t}}(I(t),n))},onReset:function(){return e({type:"RESET_MARKINGS",petriNetId:I(t)})},onAddTokens:function(n){return e(function(e,t){return{type:"ADD_TOKENS",petriNetId:e,transitionId:t}}(I(t),n))}}})(gt)),yt=(n(441),function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleClickOnPlus=function(){""!==n.state.value&&(n.props.onCreate(n.state.value),n.setState({value:""}))},n.handleChange=function(e){n.setState({value:e.target.value})},n.state={value:""},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=r.a.createElement(w.a,{type:"default",icon:"plus",onClick:this.handleClickOnPlus});return r.a.createElement("div",{className:"create_box"},r.a.createElement(M.a,{placeholder:"Name",value:this.state.value,onChange:this.handleChange,suffix:e}))}}]),t}(a.Component)),Ot=(Object(y.a)(Object(d.b)(null,function(e,t){return{onCreate:function(n){var a=function(e){return{type:"ADD_PETRI_NET",petriNetId:E()(),name:e}}(n);e(a),t.history.push("/"+a.petriNetId)}}})(yt)),n(467)),Et=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleSelect=n.handleSelect.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"handleSelect",value:function(e){this.props.onSelect(e.key)}},{key:"render",value:function(){var e=this.props.petriNets,t=this.props.selectedId;return r.a.createElement(Ot.a,{theme:"dark",selectedKeys:[""+t],onClick:this.handleSelect},e.map(function(e){return r.a.createElement(Ot.a.Item,{key:e.id},e.name)}))}}]),t}(a.Component),kt=(Object(_.a)(Object(d.b)(function(e,t){return{petriNets:function(e){return e.petriNets.map(function(t){return e.petriNetsById[t]})}(e),selectedId:t.match.params.id}},function(e,t){return{onSelect:function(e){return t.history.push("/"+e)}}})(Et)),n(449),function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={number:"1"},n.onNumberChange=function(e){var t=e.target.value;new RegExp("^[1-9]?[0-9]{0,9}$").test(t)&&(n.setState({number:t}),n.props.onNumberChange(t))},n.onLostFocus=function(){""===n.state.number&&n.setState({number:"1"})},n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.trace,n=void 0===t?"abcd":t,a=e.onDeletion;return r.a.createElement("div",null,r.a.createElement("span",null,n),r.a.createElement("div",{className:"trace-item parent"},r.a.createElement(w.a,{type:"danger",icon:"delete",className:"inline-right",onClick:a}),r.a.createElement("input",{name:"numberInput",type:"text",className:"inline-right trace-item-number form-control",placeholder:"1",required:!0,onChange:this.onNumberChange,onBlur:this.onLostFocus,value:this.state.number})))}}]),t}(r.a.Component)),jt=(n(451),function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).traceId=0,n.createTrace=function(e){return{key:n.traceId++,trace:e,number:1,active:!1}},n.state={traces:[],text:""},n.addItem=function(e){var t=Object(et.a)(n.state.traces).concat([n.createTrace(e)]);n.setState({traces:t}),n.props.petriNet.traces=t},n.deleteItem=function(e){var t=n.state.traces,a=t.findIndex(function(t){return t.key===e}),r=Object(et.a)(t.slice(0,a)).concat(Object(et.a)(t.slice(a+1)));n.setState({traces:r}),n.props.petriNet.traces=r},n.changeNumber=function(e,t){var a=n.state.traces,r=a.findIndex(function(t){return t.key===e}),i=a[r];i.number=Number(t);var c=Object(et.a)(a.slice(0,r)).concat([i],Object(et.a)(a.slice(r+1)));n.setState({traces:c}),n.props.petriNet.traces=c},n.onLabelChange=function(e){var t=e.target.value;new RegExp("^[a-zA-Z]{0,15}$").test(t)&&n.setState({text:e.target.value})},n.onSubmit=function(e){e.preventDefault();var t=n.state.text.length;0!==t&&(t>15?ht.Notify.failure("Case trace is too long, max: 15"):n.state.traces.length>25?ht.Notify.failure("Too many case traces, max: 25"):(n.addItem(n.state.text),n.setState({text:""})))},n.props.petriNet.traces=n.state.traces,n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.traces.map(function(t){var n=t.key,a=t.active,i=Object(Ee.a)(t,["key","active"]),c=a?"#90EE90":"whitesmoke";return r.a.createElement("li",{key:n,className:"list-group-item",style:{background:c}},r.a.createElement(kt,Object.assign({},i,{onNumberChange:function(t){return e.changeNumber(n,t)},onDeletion:function(){return e.deleteItem(n)}})))});return r.a.createElement("div",null,r.a.createElement("h4",{className:"case-header"},"Case traces"),r.a.createElement("form",{className:"d-flex",onSubmit:this.onSubmit},r.a.createElement("input",{type:"text",className:"form-control",style:{height:"48px"},placeholder:"Enter trace",onChange:this.onLabelChange,pattern:"[a-zA-Z]*",value:this.state.text}),r.a.createElement("button",{className:"btn btn-light",style:{height:"48px"}},"Add")),r.a.createElement("ul",{className:"list-group"},t))}}]),t}(a.Component)),Nt=Object(_.a)(Object(d.b)(function(e,t){return{petriNet:N(e,t)}},function(e,t){return{}})(jt)),It=v.a.Sider,Ct=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(It,null,r.a.createElement(Nt,null))}}]),t}(a.Component),Tt=n(18),St=(n(453),function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(f.a)(this,Object(b.a)(t).call(this,e))).handleSelect=n.handleSelect.bind(Object(T.a)(Object(T.a)(n))),n}return Object(g.a)(t,e),Object(m.a)(t,[{key:"handleSelect",value:function(e){this.props.history.push("".concat(e.key))}},{key:"render",value:function(){return r.a.createElement(Ot.a,{className:"mode_menu",mode:"horizontal",onClick:this.handleSelect,selectedKeys:[this.selectedMode()],theme:"dark"},r.a.createElement(Ot.a.Item,{className:"mode_menu__process_model",key:"edit"},r.a.createElement(Tt.a,{theme:"outlined",type:"edit"}),"Process model"),r.a.createElement(Ot.a.Item,{className:"mode_menu__run_algorithm",key:"simulate"},r.a.createElement(Tt.a,{theme:"outlined",type:"play-circle"}),"Run algorithm"))}},{key:"selectedMode",value:function(){return this.props.match.params.mode}}]),t}(a.Component)),xt=Object(_.a)(St),wt=(n(455),v.a.Header),Rt=function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(wt,{className:"topbar"},r.a.createElement(xt,null))}}]),t}(a.Component),Bt=(n(457),function(e){function t(){return Object(h.a)(this,t),Object(f.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{className:"outer_layout"},r.a.createElement(Ct,null),r.a.createElement(v.a,null,r.a.createElement(Rt,null),r.a.createElement(l.a,{path:"/:id/edit",component:$e}),r.a.createElement(l.a,{path:"/:id/simulate",component:vt}))))}}]),t}(a.Component)),At=[],_t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PETRI_NET":return Object(et.a)(e).concat([t.petriNetId]);default:return e}},Dt=n(23),Pt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_EDGE":return Object(ce.a)({},e,Object(Dt.a)({},t.edgeId,{id:t.edgeId,from:t.from,to:t.to,weight:1}));case"SET_WEIGHT":return Object(ce.a)({},e,Object(Dt.a)({},t.edgeId,Object(ce.a)({},e[t.edgeId],{weight:t.weight})));case"REMOVE_EDGE":var n=Object(ce.a)({},e);return delete n[t.edgeId],n;case"REMOVE_NODE":var a=Object(ce.a)({},e);return Object.values(e).forEach(function(e){e.from!==t.nodeId&&e.to!==t.nodeId||delete a[e.id]}),a;default:return e}},Ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NODE":return Object(ce.a)({},e,Object(Dt.a)({},t.nodeId,{id:t.nodeId,type:t.nodeType,position:Object(ce.a)({},t.position)}));case"MOVE_NODE":return Object(ce.a)({},e,Object(Dt.a)({},t.nodeId,Object(ce.a)({},e[t.nodeId],{position:Object(ce.a)({},t.position)})));case"REMOVE_NODE":var n=Object(ce.a)({},e);return delete n[t.nodeId],n;case"SET_LABEL":return Object(ce.a)({},e,Object(Dt.a)({},t.nodeId,Object(ce.a)({},e[t.nodeId],{label:t.label})));case"SET_CAPACITY_LIMIT":return Object(ce.a)({},e,Object(Dt.a)({},t.placeId,Object(ce.a)({},e[t.placeId],{capacityLimit:t.capacityLimit})));case"REMOVE_CAPACITY_LIMIT":var a=Object(ce.a)({},e);return delete a[t.placeId].capacityLimit,a;default:return e}},Lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{}],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NODE":return e.map(function(e){return Object(ce.a)({},e,Object(Dt.a)({},t.nodeId,0))});case"REMOVE_NODE":return e.map(function(e){var n=Object(ce.a)({},e);return delete n[t.nodeId],n});case"SET_CAPACITY_LIMIT":return e.map(function(e){return e[t.placeId]<=t.capacityLimit?e:Object(ce.a)({},e,Object(Dt.a)({},t.placeId,t.capacityLimit))});case"SET_INITIAL_NUMBER_OF_TOKENS":var n=Object(et.a)(e);return n[0]=Object(ce.a)({},e[0],Object(Dt.a)({},t.placeId,t.numberOfTokens)),n;case"RESET_MARKINGS":return[e[0]];default:return e}},Mt=function(e,t){switch(t.type){case"FIRE_TRANSITIONS":var n=Object(ce.a)({},e.markings[e.markings.length-1]);return G(e,t.transitionId).forEach(function(e){return n[e.from]-=e.weight}),H(e,t.transitionId).forEach(function(e){return n[e.to]+=e.weight}),Object(ce.a)({},e,{markings:Object(et.a)(e.markings).concat([n])});case"ADD_TOKENS":return G(e,t.transitionId).forEach(function(t){e.markings[e.markings.length-1][t.from]=t.weight}),Object(ce.a)({},e,{markings:Object(et.a)(e.markings)});default:var a=Object(ce.a)({},e,{edgesById:Pt(e.edgesById,t),nodesById:Ft(e.nodesById,t),markings:Lt(e.markings,t)});return a.edgesById===e.edgesById&&a.nodesById===e.nodesById&&a.markings===e.markings?e:a}},Ut={},Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_PETRI_NET":return Object(ce.a)({},e,Object(Dt.a)({},t.petriNetId,{id:t.petriNetId,name:t.name,edgesById:{},nodesById:{},markings:[{}]}));default:if(void 0===t.petriNetId)return e;var n=e[t.petriNetId],a=Mt(e[t.petriNetId],t);return n===a?e:Object(ce.a)({},e,Object(Dt.a)({},t.petriNetId,a))}},Ht=Object(p.b)({petriNets:_t,petriNetsById:Gt}),zt="87b6487b-5781-477e-8398-e2d8c36000be",Vt={petriNets:[zt],petriNetsById:Object(Dt.a)({},zt,{id:zt,name:"Sample process model",edgesById:{},nodesById:{},markings:[{}],traces:[]})},Jt=(n(460),Object(p.c)(Ht,Vt));c.a.render(r.a.createElement(d.a,{store:Jt},r.a.createElement(s.a,null,r.a.createElement(o.a,null,r.a.createElement(l.a,{path:"/:id/:mode(edit|simulate)",component:Bt}),r.a.createElement(u.a,{from:"/:id",to:"/:id/edit"}),r.a.createElement(u.a,{to:"/".concat(Jt.getState().petriNets[0],"/edit")})))),document.getElementById("root"))}},[[193,2,1]]]);
//# sourceMappingURL=main.76ff0597.chunk.js.map